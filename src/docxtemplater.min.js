!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Docxtemplater=e()}}(function(){return function e(t,r,n){function o(i,s){if(!r[i]){if(!t[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[i]={exports:{}};t[i][0].call(c.exports,function(e){var r=t[i][1][e];return o(r||e)},c,c.exports,e,t,r,n)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}({1:[function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e){return n({},"get",function(t){return"."===e?t:t[e]})}var a=e("xmldom").DOMParser,i=e("xmldom").XMLSerializer,s=e("./errors"),u=s.throwXmlTagNotFound,l=s.throwDecodeUTF8Error,c={};c.defaults={nullGetter:function(e){return e.module?(e.module,""):"undefined"},parser:o,delimiters:{start:"{",end:"}"}},c.mergeObjects=function(){for(var e={},t=void 0,r=void 0,n=0;n<arguments.length;n+=1){t=arguments[n],r=Object.keys(t);for(var o=0;o<r.length;o+=1)e[r[o]]=t[r[o]]}return e},c.xml2str=function(e){return(new i).serializeToString(e)},c.decodeUtf8=function(e){try{if(void 0===e)return;return decodeURIComponent(escape(c.convertSpaces(e)))}catch(t){l(e)}},c.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},c.str2xml=function(e,t){return new a({errorHandler:t}).parseFromString(e,"text/xml")},c.charMap={"&":"&amp;","'":"&apos;","<":"&lt;",">":"&gt;"};var p=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;c.escapeRegExp=function(e){return e.replace(p,"\\$&")},c.charMapRegexes=Object.keys(c.charMap).map(function(e){var t=c.charMap[e];return{rstart:new RegExp(c.escapeRegExp(t),"g"),rend:new RegExp(c.escapeRegExp(e),"g"),start:t,end:e}}),c.wordToUtf8=function(e){for(var t=void 0,r=0,n=c.charMapRegexes.length;r<n;r++)t=c.charMapRegexes[r],e=e.replace(t.rstart,t.end);return e},c.utf8ToWord=function(e){"string"!=typeof e&&(e=e.toString());for(var t=void 0,r=0,n=c.charMapRegexes.length;r<n;r++)t=c.charMapRegexes[r],e=e.replace(t.rend,t.start);return e},c.cloneDeep=function(e){return JSON.parse(JSON.stringify(e))},c.concatArrays=function(e){for(var t=[],r=0;r<e.length;r++)for(var n=e[r],o=0,a=n.length;o<a;o++)t.push(n[o]);return t};var f=new RegExp(String.fromCharCode(160),"g");c.convertSpaces=function(e){return e.replace(f," ")},c.pregMatchAll=function(e,t){for(var r=[],n=void 0;null!=(n=e.exec(t));)r.push({array:n,offset:n.index});return r},c.sizeOfObject=function(e){return Object.keys(e).length},c.getRight=function(e,t,r){for(var n=r,o=e.length;n<o;n++)if(e[n].value==="</"+t+">")return n;u({position:"right",element:t,parsed:e,index:r})},c.getLeft=function(e,t,r){for(var n=r;n>=0;n--){var o=e[n];if(0===o.value.indexOf("<"+t)&&-1!==[">"," "].indexOf(o.value[t.length+1]))return n}u({position:"left",element:t,parsed:e,index:r})},t.exports=c},{"./errors":2,xmldom:18}],2:[function(e,t,r){"use strict";function n(e){return e[0]}function o(e){return e[e.length-1]}function a(e){this.name="GenericError",this.message=e,this.stack=new Error(e).stack}function i(e){this.name="TemplateError",this.message=e,this.stack=new Error(e).stack}function s(e){this.name="ScopeParserError",this.message=e,this.stack=new Error(e).stack}function u(e){this.name="InternalError",this.properties={explanation:"InternalError"},this.message=e,this.stack=new Error(e).stack}function l(e){var t=new i("Multi error");throw t.properties={errors:e,id:"multi_error",explanation:"The template has multiple errors"},t}function c(e){var t=new i("Unopened tag");return t.properties={xtag:o(e.xtag.split(" ")),id:"unopened_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'+e.xtag.substr(0,10)+'" is unopened'},t}function p(e){var t=new i("Unclosed tag");return t.properties={xtag:n(e.xtag.split(" ")).substr(1),id:"unclosed_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'+e.xtag.substr(0,10)+'" is unclosed'},t}function f(e){var t=new i('No tag "'+e.element+'" was found at the '+e.position);throw t.properties={id:"no_xml_tag_found_at_"+e.position,explanation:'No tag "'+e.element+'" was found at the '+e.position,parsed:e.parsed,index:e.index,element:e.element},t}function d(e){var t=new u("End");throw t.properties={id:"utf8_decode",data:e,explanation:"Could not decode string to UTF8"},t}function h(e){var t=new u("Content must be a string");throw t.properties.id="xmltemplater_content_must_be_string",t.properties.type=e,t}function m(e){var t=new i("Raw tag not in paragraph"),r=e.part.value,n=e.part.offset;throw t.properties={id:"raw_tag_outerxml_invalid",explanation:'The tag "'+r+'" is not inside a paragraph',rootError:e.rootError,xtag:r,offset:n,postparsed:e.postparsed,expandTo:e.expandTo,index:e.index},t}function g(e){var t=new i("Raw tag should be the only text in paragraph"),r=e.part.value;throw t.properties={id:"raw_xml_tag_should_be_only_text_in_paragraph",explanation:'The tag "'+r+'" should be the only text in this paragraph',xtag:e.part.value,offset:e.part.offset,paragraphParts:e.paragraphParts},t}function v(e){var t=e.location,r="start"===t?"unclosed":"unopened",n=new i(("start"===t?"Unclosed":"Unopened")+" loop"),o=e.part.value;return n.properties={id:r+"_loop",explanation:'The loop with tag "'+o+'" is '+r,xtag:o},n}function x(e){var t=e.tags,r=new i("Closing tag does not match opening tag");return r.properties={id:"closing_tag_does_not_match_opening_tag",explanation:'The tag "'+t[0].value+'" is closed by the tag "'+t[1].value+'"',openingtag:t[0].value,offset:[t[0].offset,t[1].offset],closingtag:t[1].value},r}function y(e){var t=e.tag,r=e.rootError,n=new s("Scope parser compilation failed");return n.properties={id:"scopeparser_compilation_failed",tag:t,explanation:'The scope parser for the tag "'+t+'" failed to compile',rootError:r},n}function w(e){var t=new i('Unimplemented tag type "'+e.type+'"');throw t.properties={part:e,id:"unimplemented_tag_type"},t}function b(e){var t=new u("Malformed xml");throw t.properties={part:e,id:"malformed_xml"},t}function N(e){throw new u('Location should be one of "start" or "end" (given : '+e.location+")")}function T(e){var t=new u("The filetype for this file could not be identified, is this file corrupted ?");throw t.properties={part:e,id:"malformed_xml"},t}a.prototype=Error.prototype,i.prototype=new a,s.prototype=new a,u.prototype=new a,t.exports={XTError:a,XTTemplateError:i,XTInternalError:u,XTScopeParserError:s,throwMultiError:l,throwXmlTagNotFound:f,throwDecodeUTF8Error:d,throwContentMustBeString:h,getUnmatchedLoopException:v,throwRawTagShouldBeOnlyTextInParagraph:g,throwRawTagNotInParagraph:m,getClosingTagNotMatchOpeningTag:x,throwUnimplementedTagType:w,getScopeCompilationError:y,getUnopenedTagException:c,getUnclosedTagException:p,throwMalformedXml:b,throwFileTypeNotIdentified:T,throwLocationInvalid:N}},{}],3:[function(e,t,r){"use strict";var n=e("./modules/loop"),o=e("./modules/space-preserve"),a=e("./modules/rawxml"),i=e("./modules/expand-pair-trait"),s=e("./modules/render"),u={getTemplatedFiles:function(e){return e.file(/ppt\/(slides|slideMasters)\/(slide|slideMaster)\d+\.xml/).map(function(e){return e.name}).concat(["ppt/presentation.xml"])},textPath:"ppt/slides/slide1.xml",tagsXmlTextArray:["a:t","m:t"],tagsXmlLexedArray:["p:sp","a:tc","a:tr","a:table","a:p","a:r"],tagRawXml:"p:sp",tagTextXml:"a:t",baseModules:[n,i,a,s]},l={getTemplatedFiles:function(e){return e.file(/word\/(header|footer)\d+\.xml/).map(function(e){return e.name}).concat(["word/document.xml"])},textPath:"word/document.xml",tagsXmlTextArray:["w:t","m:t"],tagsXmlLexedArray:["w:tc","w:tr","w:table","w:p","w:r"],tagRawXml:"w:p",tagTextXml:"w:t",baseModules:[n,o,i,a,s]};t.exports={docx:l,pptx:u}},{"./modules/expand-pair-trait":7,"./modules/loop":8,"./modules/rawxml":9,"./modules/render":10,"./modules/space-preserve":11}],4:[function(e,t,r){"use strict";function n(e,t){return e[0]<=t.offset&&t.offset<e[1]}function o(e,t){return"tag"===e.type&&"start"===e.position&&e.text?(t&&h(e),!0):"tag"===e.type&&"end"===e.position&&e.text?(t||h(e),!1):t}function a(e,t){return e.offset-t.offset}function i(e){var t="start",r=1;"/"===e[e.length-2]&&(t="selfclosing"),"/"===e[1]&&(r=2,t="end");var n=e.indexOf(" "),o=-1===n?e.length-1:n;return{tag:e.slice(r,o),position:t}}function s(e,t,r){for(var n=0,o=e.length,a=m([t.map(function(e){return{tag:e,text:!0}}),r.map(function(e){return{tag:e,text:!1}})]).reduce(function(e,t){return e[t.tag]=t.text,e},{}),s=[];n<o&&-1!==(n=e.indexOf("<",n));){var u=n;n=e.indexOf(">",n);var l=e.slice(u,n+1),c=i(l),p=c.tag,f=c.position,d=a[p];null!=d&&s.push({type:"tag",position:f,text:d,offset:u,value:l})}return s}function u(e,t,r){if(0===e.length)return[];var n=[],o=!1,a={offset:0},i=void 0,s=0;e.forEach(function(e){for(;r[s+1]&&!(r[s+1].offset>e.offset);)s++;i=t.substr(a.offset,e.offset-a.offset),"start"===e.position&&o||"end"===e.position&&!o?"start"===e.position?(n.push(f({xtag:i,offset:a.offset})),e.error=!0):(n.push(d({xtag:i,offset:e.offset})),e.error=!0):o=!o,a=e});var u={offset:t.length};return i=t.substr(a.offset,u.offset-a.offset),o&&(n.push(f({xtag:i,offset:a.offset})),u.error=!0),n}function l(e,t,r){var n=[],o=-1;do{-1!==(o=e.indexOf(t,o+1))&&n.push({offset:o,position:r})}while(-1!==o);return n}function c(e){var t=this;this.innerContentParts=e,this.full="",this.parseDelimiters=function(e){t.full=t.innerContentParts.map(function(e){return e.value}).join("");var r=m([l(t.full,e.start,"start"),l(t.full,e.end,"end")]).sort(a),o=0,i=t.innerContentParts.map(function(e){return o+=e.value.length,{offset:o-e.value.length,lIndex:e.lIndex}}),s=u(r,t.full,i),c={start:e.start.length,end:e.end.length},p=0,f=0;t.parsed=i.map(function(e,t){for(var o=e.offset,a=[o,o+this.innerContentParts[t].value.length],i=this.innerContentParts[t].value,s=[];f<r.length&&n(a,r[f]);)s.push(r[f]),f++;var u=[],l=0;p>0&&(l=p,p=0),s.forEach(function(e){var t=i.substr(l,e.offset-o-l);t.length>0&&(u.push({type:"content",value:t,offset:l+o}),l+=t.length);var r={type:"delimiter",position:e.position,offset:l+o};e.error&&(r.error=e.error),u.push(r),l=e.offset-o+c[e.position]}),p=l-i.length;var d=i.substr(l);return d.length>0&&u.push({type:"content",value:d,offset:o}),u},t),t.errors=s}}var p=e("./errors"),f=p.getUnclosedTagException,d=p.getUnopenedTagException,h=p.throwMalformedXml,m=e("./doc-utils").concatArrays;t.exports={parse:function(e,t){var r=!1,n=[];e.forEach(function(e){(r=o(e,r))&&"content"===e.type&&n.push(e)});var a=new c(n);a.parseDelimiters(t);var i=[],s=0;return e.forEach(function(e){r=o(e,r),"content"===e.type&&(e.position=r?"insidetag":"outsidetag"),r&&"content"===e.type?(Array.prototype.push.apply(i,a.parsed[s].map(function(e){return"content"===e.type&&(e.position="insidetag"),e})),s++):i.push(e)}),{errors:a.errors,lexed:i}},xmlparse:function(e,t){var r=0,n=s(e,t.text,t.other).reduce(function(t,n){var o=e.substr(r,n.offset-r);return o.length>0&&t.push({type:"content",value:o}),r=n.offset+n.value.length,delete n.offset,n.value.length>0&&t.push(n),t},[]).map(function(e,t){return e.lIndex=t,e}),o=e.substr(r);return o.length>0&&n.push({type:"content",value:o}),n}}},{"./doc-utils":1,"./errors":2}],5:[function(e,t,r){"use strict";function n(e,t){for(var r=-1,n=0,o=e.length;n<o;n++)t[n]>=e[n].length||(-1===r||e[n][t[n]].offset<e[r][t[r]].offset)&&(r=n);if(-1===r)throw new Error("minIndex negative");return r}t.exports=function(e){var t=e.reduce(function(e,t){return e+t.length},0);e=e.filter(function(e){return e.length>0});for(var r=new Array(t),o=e.map(function(){return 0}),a=0;a<=t-1;){var i=n(e,o);r[a]=e[i][o[i]],o[i]++,a++}return r}},{}],6:[function(e,t,r){"use strict";function n(){}function o(e){return e}t.exports=function(e){var t={set:n,parse:n,render:n,getTraits:n,optionsTransformer:o,errorsTransformer:o,getRenderedMap:o,postparse:o};if(Object.keys(t).every(function(t){return!e[t]}))throw new Error("This module cannot be wrapped, because it doesn't define any of the necessary functions");return Object.keys(t).forEach(function(r){e[r]=e[r]||t[r]}),e}},{}],7:[function(e,t,r){"use strict";function n(e){switch(e.location){case"start":return 1;case"end":return-1;default:f(e)}}function o(e){var t=[],r=[];if(0===e.length)return{pairs:r,errors:t};var a=1,i=e[0];if("start"===i.part.location)for(var s=1;s<e.length;s++){var u=e[s];if(0===(a+=n(u.part))){var l=o(e.slice(s+1));return u.part.value!==i.part.value&&""!==u.part.value?t.push(p({tags:[i.part,u.part]})):r=[[i,u]],{pairs:r.concat(l.pairs),errors:t.concat(l.errors)}}}var f=i.part;t.push(c({part:f,location:f.location}));var d=o(e.slice(1));return{pairs:d.pairs,errors:t.concat(d.errors)}}var a=e("../mergesort"),i=e("../doc-utils"),s=e("../module-wrapper"),u=e("../traits").getExpandToDefault,l=e("../errors"),c=l.getUnmatchedLoopException,p=l.getClosingTagNotMatchOpeningTag,f=l.throwLocationInvalid,d={name:"ExpandPairTrait",postparse:function(e,t){var r=t.getTraits,n=t.postparse,s=r("expandPair",e);s=s.map(function(e){return e||[]});var l=o(s=a(s)),c=l.pairs,p=l.errors,f=c.map(function(t){var r=t[0].part.expandTo;return"auto"===r&&(r=u(e.slice(t[0].offset,t[1].offset))),r?[i.getLeft(e,r,t[0].offset),i.getRight(e,r,t[1].offset)]:[t[0].offset,t[1].offset]}),d=0,h=void 0;return{postparsed:e.reduce(function(t,r,o){var a=d<c.length&&f[d][0]<=o,i=c[d],s=f[d];if(!a)return t.push(r),t;if(s[0]===o&&(h=[]),i[0].offset!==o&&i[1].offset!==o&&h.push(r),s[1]===o){var u=e[i[0].offset];delete u.location,delete u.expandTo,u.subparsed=n(h),t.push(u),d++}return t},[]),errors:p}}};t.exports=function(){return s(d)}},{"../doc-utils":1,"../errors":2,"../mergesort":5,"../module-wrapper":6,"../traits":15}],8:[function(e,t,r){"use strict";var n=e("../doc-utils"),o=/^-([^\s]+)\s(.+)$/,a=e("../module-wrapper"),i={name:"LoopModule",parse:function(e){var t="placeholder";return"#"===e[0]?{type:t,value:e.substr(1),expandTo:"auto",module:"loop",location:"start",inverted:!1}:"^"===e[0]?{type:t,value:e.substr(1),expandTo:"auto",module:"loop",location:"start",inverted:!0}:"/"===e[0]?{type:t,value:e.substr(1),module:"loop",location:"end"}:"-"===e[0]?{type:t,value:e.replace(o,"$2"),expandTo:e.replace(o,"$1"),module:"loop",location:"start",inverted:!1}:null},getTraits:function(e,t){if("expandPair"===e)return t.reduce(function(e,t,r){return"placeholder"===t.type&&"loop"===t.module&&e.push({part:t,offset:r}),e},[])},render:function(e,t){function r(r){var a=t.scopeManager.createSubScopeManager(r,e.value);o.push(t.render(n.mergeObjects({},t,{compiled:e.subparsed,tags:{},scopeManager:a})))}if("placeholder"===!e.type||"loop"!==e.module)return null;var o=[];return t.scopeManager.loopOver(e.value,r,e.inverted),{value:o.join("")}}};t.exports=function(){return a(i)}},{"../doc-utils":1,"../module-wrapper":6}],9:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){var t=e.part,r=e.left,n=e.right,o=e.postparsed,a=e.index,i=o.slice(r+1,n);return i.forEach(function(e,n){n!==a-r-1&&("placeholder"===e.type||"content"===e.type&&"insidetag"===e.position)&&s({paragraphParts:i,part:t})}),t}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("../doc-utils"),s=e("../errors").throwRawTagShouldBeOnlyTextInParagraph,u=e("../module-wrapper"),l=function(){function e(){n(this,e),this.name="RawXmlModule"}return a(e,[{key:"optionsTransformer",value:function(e,t){return this.fileTypeConfig=t.fileTypeConfig,e}},{key:"parse",value:function(e){return"@"!==e[0]?null:{type:"placeholder",value:e.substr(1),module:"rawxml"}}},{key:"postparse",value:function(e){return i.traits.expandToOne(e,{moduleName:"rawxml",getInner:o,expandTo:this.fileTypeConfig.tagRawXml})}},{key:"render",value:function(e,t){if("rawxml"!==e.module)return null;var r=t.scopeManager.getValue(e.value);return null==r&&(r=t.nullGetter(e)),{value:r}}}]),e}();t.exports=function(){return u(new l)}},{"../doc-utils":1,"../errors":2,"../module-wrapper":6}],10:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../module-wrapper"),i=e("../errors").getScopeCompilationError,s=function(){function e(){n(this,e),this.name="Render"}return o(e,[{key:"set",value:function(e){e.compiled&&(this.compiled=e.compiled),null!=e.data&&(this.data=e.data)}},{key:"getRenderedMap",value:function(e){var t=this;return Object.keys(this.compiled).reduce(function(e,r){return e[r]={from:r,data:t.data},e},e)}},{key:"optionsTransformer",value:function(e,t){return this.parser=t.parser,e}},{key:"postparse",value:function(e){var t=this,r=[];return e.map(function(e){if("placeholder"===e.type){var n=e.value;try{t.parser(n)}catch(e){r.push(i({tag:n,rootError:e}))}}}),{postparsed:e,errors:r}}}]),e}();t.exports=function(){return a(new s)}},{"../errors":2,"../module-wrapper":6}],11:[function(e,t,r){"use strict";var n=e("../module-wrapper"),o={name:"SpacePreserveModule",postparse:function(e){var t=[],r=!1,n=e.reduce(function(e,n){return"tag"===n.type&&"start"===n.position&&n.text&&"<w:t>"===n.value&&(r=!0),r?("placeholder"!==n.type||n.module||(t[0].value='<w:t xml:space="preserve">'),t.push(n)):e.push(n),"tag"===n.type&&"end"===n.position&&n.text&&"</w:t>"===n.value&&(Array.prototype.push.apply(e,t),r=!1,t=[]),e},[]);return Array.prototype.push.apply(n,t),n}};t.exports=function(){return n(o)}},{"../module-wrapper":6}],12:[function(e,t,r){"use strict";function n(e,t,r,n){for(var o=void 0,a=0,i=e.length;a<i;a++)if(o=e[a].parse(t))return o.offset=n,r.push(o),r;return r.push({type:"placeholder",value:t,offset:n}),r}var o=e("./doc-utils"),a=o.wordToUtf8,i=o.concatArrays,s={postparse:function(e,t){function r(e,r){return t.map(function(t){return t.getTraits(e,r)})}function n(e){return t.reduce(function(e,t){var a=t.postparse(e,{postparse:n,getTraits:r});return a.errors?(o=i([o,a.errors]),a.postparsed):a},e)}var o=[];return{postparsed:n(e),errors:o}},parse:function(e,t){var r=!1,o="",i=void 0,s=[];return e.filter(function(e){return!e.error}).reduce(function(e,u){return"delimiter"===u.type?(r="start"===u.position,"end"===u.position?(o=a(o),e=n(t,o,e,i),i=null,Array.prototype.push.apply(e,s),s=[]):i=u.offset,o="",e):r?"content"!==u.type||"insidetag"!==u.position?(s.push(u),e):(o+=u.value,e):(e.push(u),e)},[])}};t.exports=s},{"./doc-utils":1}],13:[function(e,t,r){"use strict";function n(e,t){for(var r=void 0,n=0,o=t.modules.length;n<o;n++)if(r=t.modules[n].render(e,t))return r;return!1}function o(e){return e.render=o,e.modules=e.modules,e.scopeManager||(e.scopeManager=a.createBaseScopeManager(e)),e.compiled.map(function(t){var r=n(t,e);if(r)return r.value;if("placeholder"===t.type){var o=e.scopeManager.getValue(t.value);return null==o&&(o=e.nullGetter(t)),i.utf8ToWord(o)}if("content"===t.type||"tag"===t.type)return t.value;s(t)}).join("")}var a=e("./scope-manager"),i=e("./doc-utils"),s=e("./errors").throwUnimplementedTagType;t.exports=o},{"./doc-utils":1,"./errors":2,"./scope-manager":14}],14:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("./errors").XTScopeParserError,i=function(){function e(t){n(this,e),this.scopePath=t.scopePath,this.scopeList=t.scopeList,this.parser=t.parser}return o(e,[{key:"loopOver",value:function(e,t,r){return r=r||!1,this.loopOverValue(this.getValue(e),t,r)}},{key:"functorIfInverted",value:function(e,t,r){e&&t(r)}},{key:"isValueFalsy",value:function(e,t){return null==e||!e||"[object Array]"===t&&0===e.length}},{key:"loopOverValue",value:function(e,t,r){var n=Object.prototype.toString.call(e),o=this.scopeList[this.num];if(this.isValueFalsy(e,n))return this.functorIfInverted(r,t,o);if("[object Array]"!==n)return"[object Object]"===n?this.functorIfInverted(!r,t,e):this.functorIfInverted(!r,t,o);for(var a,i=0;i<e.length;i++)a=e[i],this.functorIfInverted(!r,t,a)}},{key:"getValue",value:function(e,t){this.num=null==t?this.scopeList.length-1:t;var r=void 0,n=void 0,o=this.scopeList[this.num],i=this.parser(e,{scopePath:this.scopePath});try{n=i.get(o,{num:this.num,scopeList:this.scopeList})}catch(t){throw r=new a("Scope parser execution failed"),r.properties={id:"scopeparser_execution_failed",explanation:"The scope parser for the tag "+e+" failed to execute",scope:o,tag:e,rootError:t},r}return null==n&&this.num>0?this.getValue(e,this.num-1):n}},{key:"createSubScopeManager",value:function(t,r){var n={scopePath:this.scopePath.slice(0),scopeList:this.scopeList.slice(0)};return n.parser=this.parser,n.scopeList=this.scopeList.concat(t),n.scopePath=this.scopePath.concat(r),new e(n)}}]),e}();i.createBaseScopeManager=function(e){var t=e.parser,r=e.tags,n={parser:t,tags:r};return n.scopePath=[],n.scopeList=[r],new i(n)},t.exports=i},{"./errors":2}],15:[function(e,t,r){"use strict";function n(e,t){if(0===e.length)return!1;var r=e[e.length-1].tag.substr(1),n=t.substr(2,t.length-3);return 0===r.indexOf(n)}function o(e,t){return e.push({tag:t}),e}function a(e){for(var t,r=e.filter(function(e){return"tag"===e.type}).map(function(e){return e.value}),a=[],i=0;i<r.length;i++)"/"===(t=r[i])[1]?n(a,t)?a.pop():a=o(a,t):"/"!==t[t.length-1]&&(a=o(a,t));return a}function i(e){for(var t=a(e),r=0;r<t.length;r++){var n=t[r];if(0===n.tag.indexOf("<w:tc"))return"w:tr";if(0===n.tag.indexOf("<a:tc"))return"a:tr"}return!1}function s(e,t,r){var n=e.expandTo||r.expandTo,o=t.indexOf(e);if(!n)return t;var a=void 0,i=void 0;try{a=c(t,n,o),i=p(t,n,o)}catch(r){throw r instanceof h&&m({part:e,rootError:r,postparsed:t,expandTo:n,index:o}),r}var s=t.slice(i,o),u=t.slice(o+1,a+1),l=r.getInner({index:o,part:e,leftParts:s,rightParts:u,left:i,right:a,postparsed:t});return l.length||(l.expanded=[s,u],l=[l]),f([t.slice(0,i),l,t.slice(a+1)])}function u(e,t){var r=[];return e.errors&&(r=e.errors,e=e.postparsed),e.reduce(function(e,r){return"placeholder"===r.type&&r.module===t.moduleName&&e.push(r),e},[]).forEach(function(n){try{e=s(n,e,t)}catch(e){if(!(e instanceof h))throw e;r.push(e)}}),{postparsed:e,errors:r}}var l=e("./doc-utils"),c=l.getRight,p=l.getLeft,f=l.concatArrays,d=e("./errors"),h=d.XTTemplateError,m=d.throwRawTagNotInParagraph;t.exports={expandToOne:u,getExpandToDefault:i}},{"./doc-utils":1,"./errors":2}],16:[function(e,t,r){"use strict";function n(e){function t(){var t={array:Array.prototype.slice.call(arguments)};t.array.shift();var r=t.array[0]+t.array[1];t.array.unshift(r),t.array.pop();var n=t.array.pop();t.offset=n,t.first=!0,e.matches.unshift(t)}function r(){var t={array:Array.prototype.slice.call(arguments)};t.array.pop();var r=t.array.pop();t.offset=r,t.last=!0,e.matches.push(t)}-1===e.content.indexOf("<")&&-1===e.content.indexOf(">")&&e.content.replace(/^()([^<>]*)$/,t);var n=new RegExp("^()([^<]+)</(?:"+e.tagsXmlArrayJoined+")>");return e.content.replace(n,t),n=new RegExp("(<(?:"+e.tagsXmlArrayJoined+")[^>]*>)([^>]+)$"),e.content.replace(n,r),e}function o(e,t){var r={};r.content=e,r.tagsXmlArray=t,r.tagsXmlArrayJoined=r.tagsXmlArray.join("|");var o=new RegExp("(<(?:"+r.tagsXmlArrayJoined+")[^>]*>)([^<>]*)</(?:"+r.tagsXmlArrayJoined+")>","g");return r.matches=a.pregMatchAll(o,r.content),n(r)}var a=e("./doc-utils");t.exports=function(e,t){return o(e,t)}},{"./doc-utils":1}],17:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){var r=f(e,t).matches.map(function(e){return e.array[2]});return u(l(r.join("")))}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("./doc-utils"),u=s.wordToUtf8,l=s.convertSpaces,c=s.defaults,p=e("./scope-manager"),f=e("./xml-matcher"),d=e("./errors"),h=d.throwMultiError,m=d.throwContentMustBeString,g=e("./lexer"),v=e("./parser.js"),x=e("./render.js");t.exports=function(){function e(t,r){n(this,e),this.fromJson(r),this.setModules({inspect:{filePath:this.filePath}}),this.load(t)}return i(e,[{key:"load",value:function(e){"string"!=typeof e&&m(void 0===e?"undefined":a(e)),this.content=e}},{key:"setTags",value:function(e){return this.tags=null!=e?e:{},this.scopeManager=p.createBaseScopeManager({tags:this.tags,parser:this.parser}),this}},{key:"fromJson",value:function(e){this.filePath=e.filePath,this.modules=e.modules,this.fileTypeConfig=e.fileTypeConfig,Object.keys(c).map(function(t){this[t]=null!=e[t]?e[t]:c[t]},this)}},{key:"getFullText",value:function(){return o(this.content,this.fileTypeConfig.tagsXmlTextArray)}},{key:"setModules",value:function(e){this.modules.forEach(function(t){t.set(e)})}},{key:"parse",value:function(){var e=this,t=[];this.xmllexed=g.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray}),this.setModules({inspect:{xmllexed:this.xmllexed}});var r=g.parse(this.xmllexed,this.delimiters),n=r.lexed,o=r.errors;t=t.concat(o),this.lexed=n,this.setModules({inspect:{lexed:this.lexed}}),this.parsed=v.parse(this.lexed,this.modules),this.setModules({inspect:{parsed:this.parsed}});var a=v.postparse(this.parsed,this.modules),i=a.postparsed,s=a.errors;return this.postparsed=i,(t=t.concat(s)).length&&(this.modules.forEach(function(e){t=e.errorsTransformer(t)}),t.forEach(function(t){t.properties.file=e.filePath}),h(t)),this}},{key:"render",value:function(e){this.filePath=e,this.setModules({inspect:{postparsed:this.postparsed}});var t={compiled:this.postparsed,tags:this.tags,modules:this.modules,parser:this.parser,nullGetter:this.nullGetter,filePath:this.filePath};return this.content=x(t),this.setModules({inspect:{content:this.content}}),this}}]),e}()},{"./doc-utils":1,"./errors":2,"./lexer":4,"./parser.js":12,"./render.js":13,"./scope-manager":14,"./xml-matcher":16}],18:[function(e,t,r){function n(e){this.options=e||{locator:{}}}function o(e,t,r){function n(t){var n=e[t];!n&&i&&(n=2==e.length?function(r){e(t,r)}:e),o[t]=n&&function(e){n("[xmldom "+t+"]\t"+e+s(r))}||function(){}}if(!e){if(t instanceof a)return t;e=t}var o={},i=e instanceof Function;return r=r||{},n("warning"),n("error"),n("fatalError"),o}function a(){this.cdata=!1}function i(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function s(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function u(e,t,r){return"string"==typeof e?e.substr(t,r):e.length>=t+r||t?new java.lang.String(e,t,r)+"":e}function l(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}n.prototype.parseFromString=function(e,t){var r=this.options,n=new c,i=r.domBuilder||new a,s=r.errorHandler,u=r.locator,l=r.xmlns||{},p={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return u&&i.setDocumentLocator(u),n.errorHandler=o(s,i,u),n.domBuilder=r.domBuilder||i,/\/x?html?$/.test(t)&&(p.nbsp=" ",p.copy="©",l[""]="http://www.w3.org/1999/xhtml"),l.xml=l.xml||"http://www.w3.org/XML/1998/namespace",e?n.parse(e,l,p):n.errorHandler.error("invalid doc source"),i.doc},a.prototype={startDocument:function(){this.doc=(new p).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,r,n){var o=this.doc,a=o.createElementNS(e,r||t),s=n.length;l(this,a),this.currentElement=a,this.locator&&i(this.locator,a);for(var u=0;u<s;u++){var e=n.getURI(u),c=n.getValue(u),r=n.getQName(u),p=o.createAttributeNS(e,r);this.locator&&i(n.getLocator(u),p),p.value=p.nodeValue=c,a.setAttributeNode(p)}},endElement:function(e,t,r){var n=this.currentElement;n.tagName;this.currentElement=n.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var r=this.doc.createProcessingInstruction(e,t);this.locator&&i(this.locator,r),l(this,r)},ignorableWhitespace:function(e,t,r){},characters:function(e,t,r){if(e=u.apply(this,arguments)){if(this.cdata)n=this.doc.createCDATASection(e);else var n=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(e)&&this.doc.appendChild(n),this.locator&&i(this.locator,n)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,r){e=u.apply(this,arguments);var n=this.doc.createComment(e);this.locator&&i(this.locator,n),l(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,r){var n=this.doc.implementation;if(n&&n.createDocumentType){var o=n.createDocumentType(e,t,r);this.locator&&i(this.locator,o),l(this,o)}},warning:function(e){console.warn("[xmldom warning]\t"+e,s(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,s(this.locator))},fatalError:function(e){throw console.error("[xmldom fatalError]\t"+e,s(this.locator)),e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){a.prototype[e]=function(){return null}});var c=e("./sax").XMLReader,p=r.DOMImplementation=e("./dom").DOMImplementation;r.XMLSerializer=e("./dom").XMLSerializer,r.DOMParser=n},{"./dom":19,"./sax":20}],19:[function(e,t,r){function n(e,t){for(var r in e)t[r]=e[r]}function o(e,t){function r(){}var o=e.prototype;if(Object.create){var a=Object.create(t.prototype);o.__proto__=a}o instanceof t||(r.prototype=t.prototype,n(o,r=new r),e.prototype=o=r),o.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),o.constructor=e)}function a(e,t){if(t instanceof Error)var r=t;else r=this,Error.call(this,ae[e]),this.message=ae[e],Error.captureStackTrace&&Error.captureStackTrace(this,a);return r.code=e,t&&(this.message=this.message+": "+t),r}function i(){}function s(e,t){this._node=e,this._refresh=t,u(this)}function u(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var r=e._refresh(e._node);$(e,"length",r.length),n(r,e),e._inc=t}}function l(){}function c(e,t){for(var r=e.length;r--;)if(e[r]===t)return r}function p(e,t,r,n){if(n?t[c(t,n)]=r:t[t.length++]=r,e){r.ownerElement=e;var o=e.ownerDocument;o&&(n&&y(o,e,n),x(o,e,r))}}function f(e,t,r){var n=c(t,r);if(!(n>=0))throw a(se,new Error(e.tagName+"@"+r));for(var o=t.length-1;n<o;)t[n]=t[++n];if(t.length=o,e){var i=e.ownerDocument;i&&(y(i,e,r),r.ownerElement=null)}}function d(e){if(this._features={},e)for(var t in e)this._features=e[t]}function h(){}function m(e){return"<"==e&&"&lt;"||">"==e&&"&gt;"||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function g(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(g(e,t))return!0}while(e=e.nextSibling)}function v(){}function x(e,t,r){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==r.namespaceURI&&(t._nsMap[r.prefix?r.localName:""]=r.value)}function y(e,t,r,n){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==r.namespaceURI&&delete t._nsMap[r.prefix?r.localName:""]}function w(e,t,r){if(e&&e._inc){e._inc++;var n=t.childNodes;if(r)n[n.length++]=r;else{for(var o=t.firstChild,a=0;o;)n[a++]=o,o=o.nextSibling;n.length=a}}}function b(e,t){var r=t.previousSibling,n=t.nextSibling;return r?r.nextSibling=n:e.firstChild=n,n?n.previousSibling=r:e.lastChild=r,w(e.ownerDocument,e),t}function N(e,t,r){var n=t.parentNode;if(n&&n.removeChild(t),t.nodeType===re){var o=t.firstChild;if(null==o)return t;var a=t.lastChild}else o=a=t;var i=r?r.previousSibling:e.lastChild;o.previousSibling=i,a.nextSibling=r,i?i.nextSibling=o:e.firstChild=o,null==r?e.lastChild=a:r.previousSibling=a;do{o.parentNode=e}while(o!==a&&(o=o.nextSibling));return w(e.ownerDocument||e,e),t.nodeType==re&&(t.firstChild=t.lastChild=null),t}function T(e,t){var r=t.parentNode;if(r){n=e.lastChild;r.removeChild(t);n=e.lastChild}var n=e.lastChild;return t.parentNode=e,t.previousSibling=n,t.nextSibling=null,n?n.nextSibling=t:e.firstChild=t,e.lastChild=t,w(e.ownerDocument,e,t),t}function E(){this._nsMap={}}function C(){}function D(){}function S(){}function _(){}function I(){}function O(){}function A(){}function M(){}function R(){}function k(){}function P(){}function F(){}function U(e,t){var r=[],n=9==this.nodeType?this.documentElement:this,o=n.prefix,a=n.namespaceURI;if(a&&null==o&&null==(o=n.lookupPrefix(a)))var i=[{namespace:a,prefix:null}];return j(this,r,e,t,i),r.join("")}function L(e,t,r){var n=e.prefix||"",o=e.namespaceURI;if(!n&&!o)return!1;if("xml"===n&&"http://www.w3.org/XML/1998/namespace"===o||"http://www.w3.org/2000/xmlns/"==o)return!1;for(var a=r.length;a--;){var i=r[a];if(i.prefix==n)return i.namespace!=o}return!0}function j(e,t,r,n,o){if(n){if(!(e=n(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case G:o||(o=[]);o.length;var a=e.attributes,i=a.length,s=e.firstChild,u=e.tagName;r=V===e.namespaceURI||r,t.push("<",u);for(l=0;l<i;l++)"xmlns"==(c=a.item(l)).prefix?o.push({prefix:c.localName,namespace:c.value}):"xmlns"==c.nodeName&&o.push({prefix:"",namespace:c.value});for(var l=0;l<i;l++){var c=a.item(l);if(L(c,r,o)){var p=c.prefix||"",f=c.namespaceURI,d=p?" xmlns:"+p:" xmlns";t.push(d,'="',f,'"'),o.push({prefix:p,namespace:f})}j(c,t,r,n,o)}if(L(e,r,o)){var p=e.prefix||"",f=e.namespaceURI,d=p?" xmlns:"+p:" xmlns";t.push(d,'="',f,'"'),o.push({prefix:p,namespace:f})}if(s||r&&!/^(?:meta|link|img|br|hr|input)$/i.test(u)){if(t.push(">"),r&&/^script$/i.test(u))for(;s;)s.data?t.push(s.data):j(s,t,r,n,o),s=s.nextSibling;else for(;s;)j(s,t,r,n,o),s=s.nextSibling;t.push("</",u,">")}else t.push("/>");return;case ee:case re:for(s=e.firstChild;s;)j(s,t,r,n,o),s=s.nextSibling;return;case J:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,m),'"');case H:return t.push(e.data.replace(/[<&]/g,m));case W:return t.push("<![CDATA[",e.data,"]]>");case K:return t.push("\x3c!--",e.data,"--\x3e");case te:var h=e.publicId,g=e.systemId;if(t.push("<!DOCTYPE ",e.name),h)t.push(' PUBLIC "',h),g&&"."!=g&&t.push('" "',g),t.push('">');else if(g&&"."!=g)t.push(' SYSTEM "',g,'">');else{var v=e.internalSubset;v&&t.push(" [",v,"]"),t.push(">")}return;case Q:return t.push("<?",e.target," ",e.data,"?>");case Z:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function X(e,t,r){var n;switch(t.nodeType){case G:(n=t.cloneNode(!1)).ownerDocument=e;case re:break;case J:r=!0}if(n||(n=t.cloneNode(!1)),n.ownerDocument=e,n.parentNode=null,r)for(var o=t.firstChild;o;)n.appendChild(X(e,o,r)),o=o.nextSibling;return n}function B(e,t,r){var n=new t.constructor;for(var o in t){var a=t[o];"object"!=typeof a&&a!=n[o]&&(n[o]=a)}switch(t.childNodes&&(n.childNodes=new i),n.ownerDocument=e,n.nodeType){case G:var s=t.attributes,u=n.attributes=new l,c=s.length;u._ownerElement=n;for(var p=0;p<c;p++)n.setAttributeNode(B(e,s.item(p),!0));break;case J:r=!0}if(r)for(var f=t.firstChild;f;)n.appendChild(B(e,f,r)),f=f.nextSibling;return n}function $(e,t,r){e[t]=r}function z(e){switch(e.nodeType){case G:case re:var t=[];for(e=e.firstChild;e;)7!==e.nodeType&&8!==e.nodeType&&t.push(z(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}}var V="http://www.w3.org/1999/xhtml",q={},G=q.ELEMENT_NODE=1,J=q.ATTRIBUTE_NODE=2,H=q.TEXT_NODE=3,W=q.CDATA_SECTION_NODE=4,Z=q.ENTITY_REFERENCE_NODE=5,Y=q.ENTITY_NODE=6,Q=q.PROCESSING_INSTRUCTION_NODE=7,K=q.COMMENT_NODE=8,ee=q.DOCUMENT_NODE=9,te=q.DOCUMENT_TYPE_NODE=10,re=q.DOCUMENT_FRAGMENT_NODE=11,ne=q.NOTATION_NODE=12,oe={},ae={},ie=(oe.INDEX_SIZE_ERR=(ae[1]="Index size error",1),oe.DOMSTRING_SIZE_ERR=(ae[2]="DOMString size error",2),oe.HIERARCHY_REQUEST_ERR=(ae[3]="Hierarchy request error",3)),se=(oe.WRONG_DOCUMENT_ERR=(ae[4]="Wrong document",4),oe.INVALID_CHARACTER_ERR=(ae[5]="Invalid character",5),oe.NO_DATA_ALLOWED_ERR=(ae[6]="No data allowed",6),oe.NO_MODIFICATION_ALLOWED_ERR=(ae[7]="No modification allowed",7),oe.NOT_FOUND_ERR=(ae[8]="Not found",8)),ue=(oe.NOT_SUPPORTED_ERR=(ae[9]="Not supported",9),oe.INUSE_ATTRIBUTE_ERR=(ae[10]="Attribute in use",10));oe.INVALID_STATE_ERR=(ae[11]="Invalid state",11),oe.SYNTAX_ERR=(ae[12]="Syntax error",12),oe.INVALID_MODIFICATION_ERR=(ae[13]="Invalid modification",13),oe.NAMESPACE_ERR=(ae[14]="Invalid namespace",14),oe.INVALID_ACCESS_ERR=(ae[15]="Invalid access",15);a.prototype=Error.prototype,n(oe,a),i.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var r=[],n=0;n<this.length;n++)j(this[n],r,e,t);return r.join("")}},s.prototype.item=function(e){return u(this),this[e]},o(s,i),l.prototype={length:0,item:i.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var r=this[t];if(r.nodeName==e)return r}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new a(ue);var r=this.getNamedItem(e.nodeName);return p(this._ownerElement,this,e,r),r},setNamedItemNS:function(e){var t,r=e.ownerElement;if(r&&r!=this._ownerElement)throw new a(ue);return t=this.getNamedItemNS(e.namespaceURI,e.localName),p(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return f(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var r=this.getNamedItemNS(e,t);return f(this._ownerElement,this,r),r},getNamedItemNS:function(e,t){for(var r=this.length;r--;){var n=this[r];if(n.localName==t&&n.namespaceURI==e)return n}return null}},d.prototype={hasFeature:function(e,t){var r=this._features[e.toLowerCase()];return!(!r||t&&!(t in r))},createDocument:function(e,t,r){var n=new v;if(n.implementation=this,n.childNodes=new i,n.doctype=r,r&&n.appendChild(r),t){var o=n.createElementNS(e,t);n.appendChild(o)}return n},createDocumentType:function(e,t,r){var n=new O;return n.name=e,n.nodeName=e,n.publicId=t,n.systemId=r,n}},h.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return N(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return b(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return B(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==H&&e.nodeType==H?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var r=t._nsMap;if(r)for(var n in r)if(r[n]==e)return n;t=t.nodeType==J?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var r=t._nsMap;if(r&&e in r)return r[e];t=t.nodeType==J?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},n(q,h),n(q,h.prototype),v.prototype={nodeName:"#document",nodeType:ee,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==re){for(var r=e.firstChild;r;){var n=r.nextSibling;this.insertBefore(r,t),r=n}return e}return null==this.documentElement&&e.nodeType==G&&(this.documentElement=e),N(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),b(this,e)},importNode:function(e,t){return X(this,e,t)},getElementById:function(e){var t=null;return g(this.documentElement,function(r){if(r.nodeType==G&&r.getAttribute("id")==e)return t=r,!0}),t},createElement:function(e){var t=new E;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new i,(t.attributes=new l)._ownerElement=t,t},createDocumentFragment:function(){var e=new k;return e.ownerDocument=this,e.childNodes=new i,e},createTextNode:function(e){var t=new S;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new _;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new I;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var r=new P;return r.ownerDocument=this,r.tagName=r.target=e,r.nodeValue=r.data=t,r},createAttribute:function(e){var t=new C;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new R;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var r=new E,n=t.split(":"),o=r.attributes=new l;return r.childNodes=new i,r.ownerDocument=this,r.nodeName=t,r.tagName=t,r.namespaceURI=e,2==n.length?(r.prefix=n[0],r.localName=n[1]):r.localName=t,o._ownerElement=r,r},createAttributeNS:function(e,t){var r=new C,n=t.split(":");return r.ownerDocument=this,r.nodeName=t,r.name=t,r.namespaceURI=e,r.specified=!0,2==n.length?(r.prefix=n[0],r.localName=n[1]):r.localName=t,r}},o(v,h),E.prototype={nodeType:G,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var r=this.ownerDocument.createAttribute(e);r.value=r.nodeValue=""+t,this.setAttributeNode(r)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===re?this.insertBefore(e,null):T(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);r&&this.removeAttributeNode(r)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);return r&&r.value||""},setAttributeNS:function(e,t,r){var n=this.ownerDocument.createAttributeNS(e,t);n.value=n.nodeValue=""+r,this.setAttributeNode(n)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new s(this,function(t){var r=[];return g(t,function(n){n===t||n.nodeType!=G||"*"!==e&&n.tagName!=e||r.push(n)}),r})},getElementsByTagNameNS:function(e,t){return new s(this,function(r){var n=[];return g(r,function(o){o===r||o.nodeType!==G||"*"!==e&&o.namespaceURI!==e||"*"!==t&&o.localName!=t||n.push(o)}),n})}},v.prototype.getElementsByTagName=E.prototype.getElementsByTagName,v.prototype.getElementsByTagNameNS=E.prototype.getElementsByTagNameNS,o(E,h),C.prototype.nodeType=J,o(C,h),D.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(ae[ie])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,r){r=this.data.substring(0,e)+r+this.data.substring(e+t),this.nodeValue=this.data=r,this.length=r.length}},o(D,h),S.prototype={nodeName:"#text",nodeType:H,splitText:function(e){var t=this.data,r=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var n=this.ownerDocument.createTextNode(r);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}},o(S,D),_.prototype={nodeName:"#comment",nodeType:K},o(_,D),I.prototype={nodeName:"#cdata-section",nodeType:W},o(I,D),O.prototype.nodeType=te,o(O,h),A.prototype.nodeType=ne,o(A,h),M.prototype.nodeType=Y,o(M,h),R.prototype.nodeType=Z,o(R,h),k.prototype.nodeName="#document-fragment",k.prototype.nodeType=re,o(k,h),P.prototype.nodeType=Q,o(P,h),F.prototype.serializeToString=function(e,t,r){return U.call(e,t,r)},h.prototype.toString=U;try{Object.defineProperty&&(Object.defineProperty(s.prototype,"length",{get:function(){return u(this),this.$$length}}),Object.defineProperty(h.prototype,"textContent",{get:function(){return z(this)},set:function(e){switch(this.nodeType){case G:case re:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),$=function(e,t,r){e["$$"+t]=r})}catch(e){}r.DOMImplementation=d,r.XMLSerializer=F},{}],20:[function(e,t,r){function n(){}function o(e,t,r,n,o){function c(e){if(e>65535){var t=55296+((e-=65536)>>10),r=56320+(1023&e);return String.fromCharCode(t,r)}return String.fromCharCode(e)}function h(e){var t=e.slice(1,-1);return t in r?r[t]:"#"===t.charAt(0)?c(parseInt(t.substr(1).replace("x","0x"))):(o.error("entity not found:"+e),e)}function m(t){if(t>T){var r=e.substring(T,t).replace(/&#?\w+;/g,h);w&&g(T),n.characters(r,0,t-T),T=t}}function g(t,r){for(;t>=x&&(r=y.exec(e));)v=r.index,x=v+r[0].length,w.lineNumber++;w.columnNumber=t-v+1}for(var v=0,x=0,y=/.*(?:\r\n?|\n)|.*$/g,w=n.locator,b=[{currentNSMap:t}],N={},T=0;;){try{var E=e.indexOf("<",T);if(E<0){if(!e.substr(T).match(/^\s*$/)){var C=n.doc,D=C.createTextNode(e.substr(T));C.appendChild(D),n.currentElement=D}return}switch(E>T&&m(E),e.charAt(E+1)){case"/":var S=e.indexOf(">",E+3),_=e.substring(E+2,S),I=b.pop();S<0?(_=e.substring(E+2).replace(/[\s<].*/,""),o.error("end tag name: "+_+" is not complete:"+I.tagName),S=E+1+_.length):_.match(/\s</)&&(_=_.replace(/[\s<].*/,""),o.error("end tag name: "+_+" maybe not complete"),S=E+1+_.length);var O=I.localNSMap,A=I.tagName==_;if(A||I.tagName&&I.tagName.toLowerCase()==_.toLowerCase()){if(n.endElement(I.uri,I.localName,_),O)for(var M in O)n.endPrefixMapping(M);A||o.fatalError("end tag name: "+_+" is not match the current start tagName:"+I.tagName)}else b.push(I);S++;break;case"?":w&&g(E),S=f(e,E,n);break;case"!":w&&g(E),S=p(e,E,n,o);break;default:w&&g(E);var R=new d,k=b[b.length-1].currentNSMap,S=i(e,E,R,k,h,o),P=R.length;if(!R.closed&&l(e,S,R.tagName,N)&&(R.closed=!0,r.nbsp||o.warning("unclosed xml attribute")),w&&P){for(var F=a(w,{}),U=0;U<P;U++){var L=R[U];g(L.offset),L.locator=a(w,{})}n.locator=F,s(R,n,k)&&b.push(R),n.locator=w}else s(R,n,k)&&b.push(R);"http://www.w3.org/1999/xhtml"!==R.uri||R.closed?S++:S=u(e,S,R.tagName,h,n)}}catch(e){o.error("element parse error: "+e),S=-1}S>T?T=S:m(Math.max(E,T)+1)}}function a(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function i(e,t,r,n,o,a){for(var i,s=++t,u=y;;){var l=e.charAt(s);switch(l){case"=":if(u===w)i=e.slice(t,s),u=N;else{if(u!==b)throw new Error("attribute equal must after attrName");u=N}break;case"'":case'"':if(u===N||u===w){if(u===w&&(a.warning('attribute value must after "="'),i=e.slice(t,s)),t=s+1,!((s=e.indexOf(l,t))>0))throw new Error("attribute value no end '"+l+"' match");c=e.slice(t,s).replace(/&#?\w+;/g,o),r.add(i,c,t-1),u=E}else{if(u!=T)throw new Error('attribute value must after "="');c=e.slice(t,s).replace(/&#?\w+;/g,o),r.add(i,c,t),a.warning('attribute "'+i+'" missed start quot('+l+")!!"),t=s+1,u=E}break;case"/":switch(u){case y:r.setTagName(e.slice(t,s));case E:case C:case D:u=D,r.closed=!0;case T:case w:case b:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return a.error("unexpected end of input"),u==y&&r.setTagName(e.slice(t,s)),s;case">":switch(u){case y:r.setTagName(e.slice(t,s));case E:case C:case D:break;case T:case w:"/"===(c=e.slice(t,s)).slice(-1)&&(r.closed=!0,c=c.slice(0,-1));case b:u===b&&(c=i),u==T?(a.warning('attribute "'+c+'" missed quot(")!!'),r.add(i,c.replace(/&#?\w+;/g,o),t)):("http://www.w3.org/1999/xhtml"===n[""]&&c.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+c+'" missed value!! "'+c+'" instead!!'),r.add(c,c,t));break;case N:throw new Error("attribute value missed!!")}return s;case"":l=" ";default:if(l<=" ")switch(u){case y:r.setTagName(e.slice(t,s)),u=C;break;case w:i=e.slice(t,s),u=b;break;case T:var c=e.slice(t,s).replace(/&#?\w+;/g,o);a.warning('attribute "'+c+'" missed quot(")!!'),r.add(i,c,t);case E:u=C}else switch(u){case b:r.tagName;"http://www.w3.org/1999/xhtml"===n[""]&&i.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+i+'" missed value!! "'+i+'" instead2!!'),r.add(i,i,t),t=s,u=w;break;case E:a.warning('attribute space is required"'+i+'"!!');case C:u=w,t=s;break;case N:u=T,t=s;break;case D:throw new Error("elements closed character '/' and '>' must be connected to")}}s++}}function s(e,t,r){for(var n=e.tagName,o=null,a=e.length;a--;){var i=e[a],s=i.qName,u=i.value;if((d=s.indexOf(":"))>0)var l=i.prefix=s.slice(0,d),p=s.slice(d+1),f="xmlns"===l&&p;else p=s,l=null,f="xmlns"===s&&"";i.localName=p,!1!==f&&(null==o&&(o={},c(r,r={})),r[f]=o[f]=u,i.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(f,u))}for(a=e.length;a--;)(l=(i=e[a]).prefix)&&("xml"===l&&(i.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==l&&(i.uri=r[l||""]));var d=n.indexOf(":");d>0?(l=e.prefix=n.slice(0,d),p=e.localName=n.slice(d+1)):(l=null,p=e.localName=n);var h=e.uri=r[l||""];if(t.startElement(h,p,n,e),!e.closed)return e.currentNSMap=r,e.localNSMap=o,!0;if(t.endElement(h,p,n),o)for(l in o)t.endPrefixMapping(l)}function u(e,t,r,n,o){if(/^(?:script|textarea)$/i.test(r)){var a=e.indexOf("</"+r+">",t),i=e.substring(t+1,a);if(/[&<]/.test(i))return/^script$/i.test(r)?(o.characters(i,0,i.length),a):(i=i.replace(/&#?\w+;/g,n),o.characters(i,0,i.length),a)}return t+1}function l(e,t,r,n){var o=n[r];return null==o&&((o=e.lastIndexOf("</"+r+">"))<t&&(o=e.lastIndexOf("</"+r)),n[r]=o),o<t}function c(e,t){for(var r in e)t[r]=e[r]}function p(e,t,r,n){switch(e.charAt(t+2)){case"-":return"-"===e.charAt(t+3)?(o=e.indexOf("--\x3e",t+4))>t?(r.comment(e,t+4,o-t-4),o+3):(n.error("Unclosed comment"),-1):-1;default:if("CDATA["==e.substr(t+3,6)){var o=e.indexOf("]]>",t+9);return r.startCDATA(),r.characters(e,t+9,o-t-9),r.endCDATA(),o+3}var a=m(e,t),i=a.length;if(i>1&&/!doctype/i.test(a[0][0])){var s=a[1][0],u=i>3&&/^public$/i.test(a[2][0])&&a[3][0],l=i>4&&a[4][0],c=a[i-1];return r.startDTD(s,u&&u.replace(/^(['"])(.*?)\1$/,"$2"),l&&l.replace(/^(['"])(.*?)\1$/,"$2")),r.endDTD(),c.index+c[0].length}}return-1}function f(e,t,r){var n=e.indexOf("?>",t);if(n){var o=e.substring(t,n).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(o){o[0].length;return r.processingInstruction(o[1],o[2]),n+2}return-1}return-1}function d(e){}function h(e,t){return e.__proto__=t,e}function m(e,t){var r,n=[],o=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(o.lastIndex=t,o.exec(e);r=o.exec(e);)if(n.push(r),r[1])return n}var g=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,v=new RegExp("[\\-\\.0-9"+g.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),x=new RegExp("^"+g.source+v.source+"*(?::"+g.source+v.source+"*)?$"),y=0,w=1,b=2,N=3,T=4,E=5,C=6,D=7;n.prototype={parse:function(e,t,r){var n=this.domBuilder;n.startDocument(),c(t,t={}),o(e,t,r,n,this.errorHandler),n.endDocument()}},d.prototype={setTagName:function(e){if(!x.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,r){if(!x.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:r}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},h({},h.prototype)instanceof h||(h=function(e,t){function r(){}r.prototype=t,r=new r;for(t in e)r[t]=e[t];return r}),r.XMLReader=n},{}],"/src/js/docxtemplater.js":[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("./doc-utils"),i=e("./errors"),s=i.XTInternalError,u=i.throwFileTypeNotIdentified;a.traits=e("./traits"),a.moduleWrapper=e("./module-wrapper");var l=a.moduleWrapper,c=function(){function e(){if(n(this,e),arguments.length>0)throw new Error("The constructor with parameters has been removed in docxtemplater 3.0, please check the upgrade guide.");this.compiled={},this.modules=[],this.setOptions({})}return o(e,[{key:"setModules",value:function(e){this.modules.forEach(function(t){t.set(e)})}},{key:"attachModule",value:function(e){return this.modules.push(l(e)),this}},{key:"setOptions",value:function(e){var t=this;return this.options=e,Object.keys(a.defaults).forEach(function(e){var r=a.defaults[e];t[e]=null!=t.options[e]?t.options[e]:r}),this.zip&&this.updateFileTypeConfig(),this}},{key:"loadZip",value:function(e){if(e.loadAsync)throw new s("Docxtemplater doesn't handle JSZip version >=3, see changelog");return this.zip=e,this.updateFileTypeConfig(),this}},{key:"compileFile",value:function(e){var t=this.createTemplateClass(e);t.parse(),this.compiled[e]=t}},{key:"compile",value:function(){var e=this;return this.options.xmlFileNames=[],this.modules=this.fileTypeConfig.baseModules.map(function(e){return e()}).concat(this.modules),this.options=this.modules.reduce(function(t,r){return r.optionsTransformer(t,e)},this.options),this.xmlDocuments=this.options.xmlFileNames.reduce(function(t,r){var n=e.zip.files[r].asText();return t[r]=a.str2xml(n),t},{}),this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments,data:this.data}),this.getTemplatedFiles(),this.setModules({compiled:this.compiled}),this.templatedFiles.forEach(function(t){null!=e.zip.files[t]&&e.compileFile(t)}),this}},{key:"updateFileTypeConfig",value:function(){var t=this,r={docx:"word/document.xml",pptx:"ppt/presentation.xml"},n=Object.keys(r).reduce(function(e,n){return e||(t.zip.files[r[n]]?n:e)},null);return n||u(),this.fileType=n,this.fileTypeConfig=this.options.fileTypeConfig||e.FileTypeConfig[this.fileType],this}},{key:"render",value:function(){var e=this;return this.compile(),this.mapper=this.modules.reduce(function(e,t){return t.getRenderedMap(e)},{}),Object.keys(this.mapper).forEach(function(t){var r=e.mapper[t],n=r.from,o=e.compiled[n];o.setTags(r.data),o.render(t),e.zip.file(t,o.content)}),this.syncZip(),this}},{key:"syncZip",value:function(){var e=this;Object.keys(this.xmlDocuments).forEach(function(t){e.zip.remove(t);var r=a.xml2str(e.xmlDocuments[t]);return e.zip.file(t,r,{})})}},{key:"setData",value:function(e){return this.data=e,this}},{key:"getZip",value:function(){return this.zip}},{key:"createTemplateClass",value:function(e){var t=this.zip.files[e].asText();return this.createTemplateClassFromContent(t,e)}},{key:"createTemplateClassFromContent",value:function(t,r){var n=this,o={filePath:r};return Object.keys(a.defaults).forEach(function(e){o[e]=n[e]}),o.fileTypeConfig=this.fileTypeConfig,o.modules=this.modules,new e.XmlTemplater(t,o)}},{key:"getFullText",value:function(e){return this.createTemplateClass(e||this.fileTypeConfig.textPath).getFullText()}},{key:"getTemplatedFiles",value:function(){return this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip),this.templatedFiles}}]),e}();c.DocUtils=e("./doc-utils"),c.Errors=e("./errors"),c.XmlTemplater=e("./xml-templater"),c.FileTypeConfig=e("./file-type-config"),c.XmlMatcher=e("./xml-matcher"),t.exports=c},{"./doc-utils":1,"./errors":2,"./file-type-config":3,"./module-wrapper":6,"./traits":15,"./xml-matcher":16,"./xml-templater":17}]},{},[])("/src/js/docxtemplater.js")});